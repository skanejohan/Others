<html>

<style>
    html, body {
        width:  100%;
        height: 100%;
        margin: 0px;
        background-color: ecd9c6;
    }
</style>

<canvas id="gameCanvas"></canvas>

<link href="https://fonts.googleapis.com/css?family=Caudex" rel="stylesheet">

<script type="text/javascript" src="theseus.framework.js"></script>

<script type="text/javascript" src="theseus.drawing.canvas.js"></script>
<script type="text/javascript" src="theseus.drawing.canvas.extensions.js"></script>
<script type="text/javascript" src="theseus.drawing.layers.js"></script>
<script type="text/javascript" src="theseus.drawing.gameobjects.js"></script>
<script type="text/javascript" src="theseus.drawing.scene.js"></script>
<script type="text/javascript" src="theseus.drawing.utils.js"></script>

<script type="text/javascript" src="parswick.game.js"></script>
<script type="text/javascript" src="parswick.game.drawingextensions.js"></script>

<script>
    var canvas;
    var canvasContext;
    var mousePos = { x: 0, y: 0 };
    var sizedCanvas;
    var layers;

    const COLORS = {
        bg: "black",
        fg: "#ecd9c6",
        hintBg: "gray",
        hintFg: "#ecd9c6", 
        verbBg: "#a0a0a0",
        verbFg: "white",
    }
    const FPS = 30;

    window.onload = function() {
        canvas = document.getElementById("gameCanvas");
        canvasContext = canvas.getContext("2d");
        sizedCanvas = new THESEUS.DRAWING.Canvas(canvas, 800, 450);
        layers = new THESEUS.DRAWING.Layers();
        canvasContext.translate(0.5, 0.5);
        THESEUS.DRAWING.GAMEOBJECTS.initialize(sizedCanvas, layers, COLORS, THESEUS.DRAWING.SCENE.getDrawState);

        THESEUS.PARSWICK.startGame();

        setInterval(function() {
            sizedCanvas.setScale(window.innerWidth, window.innerHeight);
            THESEUS.DRAWING.GAMEOBJECTS.setMousePos(mousePos);
            layers.clear();
            THESEUS.DRAWING.SCENE.draw();
            layers.draw();
        }, 1000 / FPS);

        canvas.addEventListener("mousemove",
            function(evt) {
                calculateMousePos(evt);
            });

        canvas.addEventListener("click", 
            function(evt) {
                THESEUS.DRAWING.SCENE.click();
            }); 
    }

    function calculateMousePos(evt) {
        var rect = canvas.getBoundingClientRect();
        var root = document.documentElement;
        var x = evt.clientX - rect.left - root.scrollLeft;
        var y = evt.clientY - rect.top - root.scrollTop;
        mousePos = { 
            x : evt.clientX - rect.left - root.scrollLeft,
            y : evt.clientY - rect.top - root.scrollTop 
        }
    }

    function load() {
        THESEUS.context.restore("M-THESEUS.PARSWICK.kitchen,A-THESEUS.PARSWICK.cupboard-open,A-THESEUS.PARSWICK.cup-take,A-THESEUS.PARSWICK.officeDoorKey-take,M-THESEUS.PARSWICK.fictionSection,M-THESEUS.PARSWICK.artSection,M-THESEUS.PARSWICK.historySection,A-THESEUS.PARSWICK.officeDoor-unlock,A-THESEUS.PARSWICK.officeDoor-open,M-THESEUS.PARSWICK.office,A-THESEUS.PARSWICK.cabinet-open,A-THESEUS.PARSWICK.metalBox-take,A-THESEUS.PARSWICK.desk-examine,A-THESEUS.PARSWICK.drawer-open,A-THESEUS.PARSWICK.paperClip-take,A-THESEUS.PARSWICK.metalBox-pick,A-THESEUS.PARSWICK.metalBox-open,A-THESEUS.PARSWICK.rockPick-take,A-THESEUS.PARSWICK.safe-examine,A-THESEUS.PARSWICK.safe-enterCombination-1979,A-THESEUS.PARSWICK.safe-open,A-THESEUS.PARSWICK.houseHistoryBook-take,A-THESEUS.PARSWICK.houseHistoryBook-examine,M-THESEUS.PARSWICK.historySection,M-THESEUS.PARSWICK.artSection,M-THESEUS.PARSWICK.fictionSection,M-THESEUS.PARSWICK.travelSection,A-THESEUS.PARSWICK.languageShelf-examine,A-THESEUS.PARSWICK.latinDictionary-take,A-THESEUS.PARSWICK.houseHistoryBook-examine,M-THESEUS.PARSWICK.fictionSection,M-THESEUS.PARSWICK.artSection,M-THESEUS.PARSWICK.historySection,A-THESEUS.PARSWICK.historyBookShelf-examine,A-THESEUS.PARSWICK.historyBookShelf-empty,A-THESEUS.PARSWICK.historyBookShelf-pull,A-THESEUS.PARSWICK.wall-examine,A-THESEUS.PARSWICK.wall-hit");
    }

</script>
</html>