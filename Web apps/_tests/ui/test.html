<!DOCTYPE html>
<html>
    <style>
        html, body {
            width:  100%;
            height: 100%;
            margin: 0px;
            background-color: ecd9c6;
        }
    </style>
    
<head>
    <title>Test</title>
    <script src="..\..\_include\timing\timer.js"></script>
    <script src="..\..\_include\timing\timedvaluemodifier.js"></script>
    <script src="..\..\_include\drawing\scaling_canvas.js"></script>
    <script src="..\..\_include\drawing\ui\animations.js"></script>
    <script src="..\..\_include\drawing\ui\elements.js"></script>
    <script src="..\..\_include\drawing\ui\engine.js"></script>

    <script>
        var engine;
        var sizedCanvas;

        function draw(timestamp) {
            window.requestAnimationFrame(draw);
            sizedCanvas.setDimensions(window.innerWidth, window.innerHeight);
            engine.draw();
        }

        function randomElement(x, y, fn) {
            switch(Math.floor(Math.random() * 2)) {
                case 0: return { layer : 0, element : new FillRect(x, y, 100, 100, "red", fn) };
                case 1: return { layer : 1, element : new Rect(x, y, 100, 100, "black", fn) };
            }
        }

        function init() {
            let w = 800;
            let h = 450;
            sizedCanvas = new ScalingCanvas(document.getElementById("canvas"), w, h);
            engine = new Engine(sizedCanvas);

            engine.onclick = function(x, y, elem) {
                var e = randomElement(x, y, () => {
                    e.element.finishAfterAnimations = true; 
                    e.element.popup.fadeOut(200);
                    e.element.fadeOut(200); });
                e.element.popup = new Rect(0, 0, 100, 100, "red");
                e.element.fadeIn(200);
                engine.add(e.element, e.layer);
            }

            window.requestAnimationFrame(draw);
        }
</script>
</head>

<body onload="init();">
    <canvas id="canvas" />
</body>

</html>
